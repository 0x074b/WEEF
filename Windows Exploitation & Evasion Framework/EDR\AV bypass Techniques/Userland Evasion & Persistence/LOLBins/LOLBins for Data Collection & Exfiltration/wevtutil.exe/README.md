# wevtutil.exe  

## What is it?  
*`wevtutil.exe` is a built-in Windows command-line utility for managing Windows Event Logs.  
It allows users to query, export, clear, and configure event logs, making it a powerful tool for system administration.*

*Because `wevtutil.exe` is a **trusted** system binary, security tools may **overlook its misuse**, making it valuable for attackers who want to **cover their tracks** or **extract valuable system logs**.* 

## Legitimate Usage  
- **Query System Logs** → View log entries (`wevtutil qe System /c:10 /rd:true /f:text`)  
- **Export Event Logs** → Save logs for forensic analysis (`wevtutil epl Security logs.evtx`)  
- **Clear Event Logs** → Remove logs to free up space (`wevtutil cl Security`)  
- **Enable or Disable Logging** → Modify log settings (`wevtutil set-log Application /enabled:true`)  

## How to Abuse it  
- **Log Clearing to Cover Tracks** → Attackers can erase security logs to hinder investigations  
- **Event Log Dumping** → Extract logs to find valuable security-related information  
- **Disabling Security Logging** → Prevent detection of malicious activities  
- **Bypassing SIEM Monitoring** → Security Information and Event Management (SIEM) systems rely on logs, and clearing them reduces visibility  

## Example Attacks  

### 1. Dumping Security Logs for Reconnaissance  
*Attackers can extract Windows Security logs to analyze authentication events, privilege escalations, and system changes.*

**Export Security Event Logs:**

```
wevtutil epl Security C:\Temp\Security.evtx
```

**Effect:**
- Saves all Security event logs to `Security.evtx`  
- Helps attackers analyze system activity without direct access to the Event Viewer  

### 2. Clearing Event Logs to Remove Evidence  
*Malicious actors delete logs to erase traces of their activities.*

**Clear the Security Log:**

```
wevtutil cl Security
```

**Effect:**
- Completely removes all logs from the Security log  
- Prevents forensic investigators from tracing suspicious activities  

### 3. Disabling Logging for Stealth  
*An attacker can stop logs from being recorded, making detection more difficult.*

**Disable a Specific Log Channel:**

```
wevtutil set-log Security /enabled:false
```

**Effect:**
- Prevents new logs from being recorded in the Security event log  
- Can be used to disrupt security monitoring tools  

### 4. Listing Available Event Logs for Enumeration  
*Attackers may enumerate available logs to find security configurations and audit policies.*

**List All Available Event Logs:**

```
wevtutil el
```

**Effect:**
- Displays all log categories, including Security, Application, and System  
- Helps attackers identify useful logs to extract  

## Detection & Mitigation  

### Detection Methods  
**Monitor Event Log Clearing**
- Watch for `Event ID 1102` (Security log cleared)  
- Detect frequent execution of `wevtutil cl` commands  

**Monitor Unauthorized Log Modifications**
- Identify `Event ID 104` (Audit log cleared)  
- Look for commands disabling event logs (`wevtutil set-log ... /enabled:false`)  

### Mitigation Strategies  
- **Restrict Access to wevtutil.exe** → Use AppLocker or WDAC to prevent unauthorized execution  
- **Enable Event Logging Backup** → Forward logs to a remote system to prevent deletion impact  
- **Monitor Log Modification Attempts** → Alert on unauthorized log changes  
