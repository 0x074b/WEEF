# whoami.exe  

## What is it?  
*`whoami.exe` is a built-in Windows command-line utility that displays information about the current user, including their username, groups, privileges, and logon ID.*

*Since `whoami.exe` is a **trusted** system binary, security tools may **overlook its misuse**, making it useful for attackers conducting **privilege reconnaissance** and **environment enumeration**.*

## Legitimate Usage  
- **Identify Current User** → Display the active user account (`whoami`)  
- **List Group Memberships** → Show all groups the user belongs to (`whoami /groups`)  
- **Check User Privileges** → See active privileges (`whoami /priv`)  
- **Display Logon ID** → Find session details (`whoami /logonid`)  

## How to Abuse it  
- **Privilege Escalation Recon** → Determine if the user has admin or system-level privileges  
- **Lateral Movement Recon** → Check group memberships for potential access escalation  
- **Credential Theft Preparation** → Identify high-value targets before launching attacks  
- **Stealthy Reconnaissance** → Use `whoami.exe` to avoid triggering security alerts  

## Example Attacks  

### 1. Checking for Administrator Privileges  
*Attackers can verify if they have admin access before running privilege escalation exploits.*

**Check User Privileges:**

```
whoami /priv
```

**Effect:**
- Lists all privileges granted to the user  
- Identifies if the user has SeImpersonatePrivilege (useful for token manipulation attacks)  

### 2. Finding High-Privilege Group Memberships  
*Attackers can check if the current user is part of sensitive groups like Administrators, Remote Desktop Users, or Domain Admins.*

**List Group Memberships:**

```
whoami /groups
```

**Effect:**
- Displays all security groups the user is a part of  
- Helps attackers identify if they have special access  

### 3. Identifying Logon Session for Credential Theft  
*Attackers can extract session information to locate valuable logon credentials.*

**Retrieve Logon Session ID:**  

```
whoami /logonid
```

**Effect:**
- Provides the logon ID of the current session  
- Useful for tools like Mimikatz to extract credentials from active sessions  

### 4. Enumerating the Environment Without Suspicion  
*Attackers use `whoami.exe` in combination with other reconnaissance tools to gather system details stealthily.*

**Combine with System Info:**

```
whoami && hostname && systeminfo
```

**Effect:**
- Displays the current user, computer name, and system details  
- Helps attackers map the target environment before executing attacks  

## Detection & Mitigation  

### Detection Methods  
**Monitor Unusual whoami.exe Usage**
- Look for excessive execution of `whoami /priv` or `whoami /groups`  
- Detect `whoami.exe` usage within scripts or automated reconnaissance tools  

**Correlate with Other Reconnaissance Commands**
- Flag `whoami.exe` when executed alongside `net user`, `ipconfig`, or `systeminfo`  

### Mitigation Strategies  
- **Restrict Unnecessary Privileges** → Remove excessive privileges from standard users  
- **Monitor and Log Command Execution** → Track suspicious uses of `whoami.exe` in security logs  
- **Enable Least Privilege Access Control** → Limit user access to administrative groups  
