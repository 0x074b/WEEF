# Scheduled Tasks & Service Manipulation
*Exploiting Windows task scheduling and service management to maintain persistence or escalate privileges.*
*( 1 → 5 = stealth level, 5 being the stealthiest )*

- **psexec.exe** → 1
  - Creates a **remote service** (```PSEXESVC```), which is highly **visible in logs**.
  - **Triggers network events** (SMB, RPC).
  - Generates **logon events** (Event ID 4624, 4648).
  - **Frequently flagged by EDR/AV** due to its heavy use in **lateral movement**.

- **sc.exe** → 2
  - Used to **create, modify, or delete services**, making it highly **visible** in **Event Logs** (Event ID 7045 - Service Creation).
  - Requires **administrative privileges**, further increasing detection risks.
  - **Less noisy than PsExec** because it does not create **new logon events** or use **SMB**.

- **schtasks.exe** → 3
  - Creates **scheduled tasks**, which can be **monitored in Event Logs** (Event ID 4698 - Scheduled Task Created).
  - Commonly abused for **persistence**, but **often blended with legitimate activity**.
  - **Less suspicious than service creation** but still detectable.

- **taskkill.exe** → 1
  - Used to **terminate processes**, leaving **fewer forensic artifacts** compared to the others.
  - May trigger **Event ID 4688 (Process Execution)** or **EDR alerts**, but **not as loud** as service creation.
  - Blends into normal admin activity.

- wmic.exe → 4
  - Executes **WMI queries**, which are **often overlooked** in logs.
  - Can perform **remote process execution, reconnaissance, and persistence** with minimal footprint.
  - Leaves logs, but detection is harder since WMI is used by **system processes** and **legitimate admins**.
  - **Frequently abused in stealthy attacks (e.g., fileless malware, LOLBins)**.

# Registry-Based Persistence & UAC Bypass
*Using the Windows registry to ensure malicious execution at startup or to bypass User Account Control (UAC).*

- **cmd.exe** → 1
   - **Process Creation Logging:** Easily logged (**Event ID 4688**), making activity visible.  
   - **Frequent Use in Batch Scripts:** Many attacks use **`cmd.exe`** to launch other tools.  
   - **Heavily Monitored:** Security tools often flag **suspicious commands** executed through **`cmd.exe`**.  

- **cmstp.exe** → 5
   - **Executes Malicious DLLs:** Allows attackers to **run payloads with system privileges**.  
   - **Less Logging:** Can execute files **without generating process creation logs**.  
   - **Some EDR Awareness:** Due to past **abuse**, some security tools monitor it.  

- **compmgmtlauncher.exe** → 5
   - **UAC Bypass Method:** Allows **privilege escalation** without direct process spawning.  
   - **Not Commonly Logged:** Often **ignored in security event logging**.  
   - **Rarely Abused:** Not **widely known or used** in offensive operations.  

- **control.exe** → 4
   - **Runs GUI Elements:** Used to **open Control Panel settings**, not usually monitored.  
   - **Can Execute Code Indirectly:** Some **abuse cases exist, but rare**.  
   - **Blends Into Legitimate Activity:** Unlikely to **trigger alerts**.  

- **fodhelper.exe** → 5
   - **Runs as High-Integrity:** Executes with **elevated privileges** without an explicit **UAC prompt**.  
   - **Minimal Logging:** Does **not create process execution logs** in some cases.  
   - **Not Directly Flagged by EDRs:** Many **security tools do not monitor it actively**.  

- **mshta.exe** → 4
   - **Executes Malicious HTML Apps:** Allows attackers to **run arbitrary scripts**.  
   - **Not Always Monitored:** Some environments **lack detection** for HTA execution.  
   - **Can Bypass AppLocker:** If misconfigured, it allows **execution of unsigned scripts**.  

- **netsh.exe** → 1
   - **Network Manipulation:** Often used to **modify firewall rules, enable proxy settings, or capture packets**.  
   - **EDR Visibility:** **Network configuration changes** trigger alerts in security monitoring tools.  
   - **Used in Malware:** Frequently abused to **disable Windows Defender firewall**.  

- **pcalua.exe** → 5
   - **Bypasses UAC Restrictions:** Runs as an **elevated process** without user prompts.  
   - **Rarely Monitored:** Not a **common target in security policies**.  
   - **Limited Attack Usage:** Requires **specific conditions for successful abuse**.

- **powershell.exe** → 1
   - **Extensive Logging:** Script Block Logging (**Event ID 4104**) and Command Line Logging (**Event ID 4688**) track activity.  
   - **AMSI Detection:** Many security tools inspect **PowerShell execution** in real time.  
   - **Commonly Abused:** Frequently used in **malware, pentesting, and post-exploitation frameworks** (e.g., Cobalt Strike).  

- **reg.exe** → 2
   - **Registry Modifications:** Directly edits **registry keys**, which is a **key persistence method**.  
   - **Logged in Windows Events:** Registry changes can be monitored via **Event IDs 4657 and 4663**.  
   - **Used for Malware Persistence:** Often seen in **malware modifying Run keys** for startup execution.  

- **regedit.exe** → 1
   - **GUI-Based Registry Editing:** Requires **user interaction**, making it less useful for automated attacks.  
   - **Limited CLI Abuse:** Unlike **`reg.exe`**, its **automation options are limited**.  
   - **Still Leaves Traces:** **Registry modifications** are logged, but detection depends on user activity.
 
- **sdclt.exe** → 5
   - **Used for UAC Bypass:** Can be leveraged to **execute commands as an elevated process**.  
   - **Not Frequently Monitored:** Security solutions **do not prioritize** this binary.  
   - **Less Commonly Abused:** Used in specific **privilege escalation techniques** but not widely known.  

- **wscript.exe / cscript.exe** → 5
   - **Executes VBScript/JScript:** Useful for **fileless malware execution**.  
   - **Less Suspicious Than PowerShell:** Some environments **do not aggressively monitor** it.  
   - **Still Detectable:** Some **EDRs flag excessive scripting engine usage**.

# DLL Hijacking & Binary Hijacking
*Abusing DLL search order hijacking and trusted Windows binaries to execute arbitrary code for persistence.*

- **appvlp.exe** → 4
   - **Rarely Monitored:** Used for launching **App-V applications**, making it an **uncommon attack vector**.  
   - **Bypasses Some Security Controls:** Can be leveraged to execute payloads while **blending into legitimate activity**.  
   - **Low Detection Rate:** Security tools do not **prioritize appvlp.exe abuse**, making it one of the stealthiest options.

- **dism.exe** → 3
   - **System Imaging Utility:** Used for **modifying Windows images**, installing/uninstalling system components.  
   - **Logged in Windows Event Logs:** Commands are often logged, making detection easier.  
   - **Rarely Abused in Attacks:** Not commonly used for stealthy execution, making **suspicious usage stand out**.  

- **msiexec.exe** → 3
   - **Commonly Used for Malware Deployment:** Frequently abused to **execute malicious MSI packages** or remote payloads.  
   - **Command Line Visibility:** Execution can be detected through **Event ID 4688** and command-line logging.  
   - **Network Activity Logging:** Can fetch payloads via **HTTP/HTTPS**, which can trigger alerts.
  
- **regsvr32.exe** → 3
   - **Used for DLL Registration:** Loads COM objects and **can be abused for executing remote scripts**.  
   - **Bypasses Application Whitelisting:** Can execute scripts from remote locations without dropping files.  
   - **Partially Monitored:** Some security solutions track its use, but it often evades basic detection.  

- **rundll32.exe** → 3
   - **Executes DLLs with Arbitrary Exports:** Attackers can use it to run **malicious payloads in-memory**.  
   - **Less Logging Than PowerShell:** Does not generate **high-level script block logs** like PowerShell.  
   - **Commonly Used in LOLBins:** Many security solutions now **monitor unusual rundll32 usage**.

# Installer & System Management Abuses
*Misusing installation utilities and system management tools to deploy persistent malware or gain elevated privileges.*

- **gpupdate.exe** → 3
   - **Triggers Group Policy Updates:** Used for **applying new policies** to a system, making it a common admin tool.  
   - **Blends into Normal Activity:** Often run by **system administrators**, making it less suspicious.  
   - **Can Be Abused for Policy Refresh Attacks:** Attackers can use it to **force malicious group policies** into effect.  

- **iexpress.exe** → 5
   - **Microsoft-Signed Setup Utility:** Used to **package self-extracting executables**, which is a normal function.  
   - **Less Suspicious Unless Misused:** **Custom-built installers** might evade detection unless they contain **malicious scripts**.  
   - **Can Run Without Raising Alerts:** **Most security solutions do not actively flag `iexpress.exe` executions**.  

- **InstallUtil.exe** → 1
   - **Commonly Abused for Execution:** Frequently used in **malware and red team operations** for executing payloads.  
   - **Triggers Event Logs:** Generates **Event ID 4688 (Process Creation)** and **Event ID 5961 (Application Crashes)** if execution fails.  
   - **Often Flagged by Security Tools:** Many EDR/AV solutions detect **unsigned binaries executed via InstallUtil**. 

- **msbuild.exe** → 2
   - **Living-off-the-Land Binary (LOLBas):** Can execute **inline C# code**, making it a target for attackers.  
   - **Microsoft-Signed, but Monitored:** EDR solutions track abnormal **`msbuild.exe`** executions.  
   - **Less Common in Everyday Use:** Unlike `gpupdate.exe`, execution by non-developers can be a red flag.

- **rpcping.exe** → 2
   - **Used for Remote Procedure Calls (RPC):** Can be used to **enumerate RPC services or trigger remote execution**.  
   - **Generates Network Traffic:** May raise alerts due to abnormal **RPC requests** to unauthorized endpoints.  
   - **Not Always Monitored:** Often ignored unless **run from a suspicious directory** or in combination with other tools.  

- **wermgr.exe** → 5
   - **Windows Error Reporting Tool:** Normally used for **crash reporting**, making it **rarely flagged**.  
   - **Can Be Used for C2 Communication:** Attackers abuse it to **exfiltrate data** by hijacking error reporting.  
   - **Runs Silently in the Background:** Executions can be **mistaken for legitimate system processes**.  

# Credential Theft & Token Manipulation
*Extracting or misusing stored credentials and authentication tokens to escalate privileges and move laterally.*

- **cmdkey.exe** → 3
   - **Manages Stored Credentials:** Allows listing, adding, and deleting stored Windows credentials.  
   - **Credential Harvesting Potential:** Attackers can use it to **extract saved RDP or SMB passwords**.  
   - **Logged But Overlooked:** Triggers **Event ID 4798 (Enumeration of Credentials)** but is **less scrutinized** than `runas.exe`.  

- **runas.exe** → 1
   - **Explicit Privilege Escalation:** Used to **run programs as another user**, making its execution highly suspicious if abused.  
   - **Logged in Security Events:** Creates **Event ID 4648 (Explicit Logon)**, making it easy to track credential usage.  
   - **Requires Visible Credentials:** If misused interactively, **password prompts appear**, making detection easier.

- **vaultcmd.exe** → 4
   - **Accesses Windows Credential Vault:** Used to **retrieve and manage stored credentials**, often **without raising immediate suspicion**.  
   - **Less Monitored in Real-World Attacks:** Security tools **rarely flag vaultcmd.exe usage**, making it a **low-profile attack vector**.  
   - **No Immediate Logon Events:** Unlike `runas.exe` or `cmdkey.exe`, it does not directly **trigger logon-related alerts**.  


# WMI & Event Subscription Persistence
*Leveraging Windows Management Instrumentation (WMI) and event subscriptions to execute malicious code stealthily and persistently.*

- **powershell.exe** → 1
   - **Extensive Logging:** PowerShell activity is logged in **Windows Event Logs** (Event IDs **4103, 4104, 4688**).  
   - **Heavy Security Monitoring:** Many **EDR/XDR solutions** track PowerShell execution due to its frequent use in attacks.  
   - **Obfuscation Detection:** Even **obfuscated scripts** can be detected through **script block logging** if enabled.
 
- **wmic.exe** → 3
   - **Legacy Command Execution:** Uses **WMI** (Windows Management Instrumentation) for **remote execution and reconnaissance**.  
   - **Logged in Event Logs:** Can trigger **Event ID 4688 (Process Creation)** when running commands.  
   - **Still Monitored, but Less Than PowerShell:** Though less common than PowerShell, **modern security tools still flag it**.  

- **winrm.vbs** → 3
   - **Uses Windows Remote Management (WinRM):** Commonly used for **remote command execution**.  
   - **Requires WinRM Service:** If disabled, execution attempts fail—raising suspicion.  
   - **Leaves Network Traces:** Generates **WinRM logs** and **Event ID 4648 (Explicit Logon)** when used for remote authentication.  

- **wscript.exe / cscript.exe** → 5
   - **Executes VBScript & JScript:** Can run malicious scripts **without spawning visible windows**.  
   - **Often Overlooked:** Many security tools **prioritize PowerShell over Windows Script Host (WSH)**.  
   - **No Immediate Suspicion:** **Commonly used in enterprise environments**, making its execution blend in with normal activity.  
